# 設定ファイルフォーマット仕様

## 概要
Inference Proxyの設定は、YAML形式のファイルで管理されます。このドキュメントでは、設定ファイルの構造と各設定項目について説明します。

## ファイル構造
設定ファイルは以下の2つの主要セクションで構成されています：
1. `services` - プロキシが管理するAIサービスの設定
2. `logging` - ログ出力に関する設定

## サービス設定 (services)
サービス設定は配列として定義され、複数のサービスを指定できます。各サービスには以下の属性があります：

| 項目 | 型 | 必須 | 説明 | 制約 |
|------|------|------|------|------|
| name | 文字列 | ✓ | サービスの識別名 | 空文字列は不可 |
| image | 文字列 | ✓ | Dockerイメージ名 | 空文字列は不可 |
| port | 整数 | ✓ | サービスのポート番号 | 1〜65535の範囲内 |

## ログ設定 (logging)
ログ設定は以下の属性を持ちます：

| 項目 | 型 | 必須 | デフォルト値 | 説明 | 制約 |
|------|------|------|------|------|------|
| output_dir | 文字列 | ✓ | - | ログファイル出力ディレクトリ | 空文字列は不可 |
| level | 文字列 | - | INFO | ログレベル | DEBUG, INFO, WARNING, ERROR, CRITICALのいずれか |

## 環境変数によるオーバーライド
以下の環境変数を設定することで、設定ファイルの値をオーバーライドできます：

| 環境変数 | 影響範囲 | 説明 |
|----------|----------|------|
| INFERENCE_PROXY_SERVICE_PORT | すべてのサービス | すべてのサービスのポート番号をオーバーライド |
| INFERENCE_PROXY_LOG_LEVEL | ログ設定 | ログレベルをオーバーライド |

## 設定例
```yaml
# サービス設定
services:
- name: text-generation-model
  image: ai-model:latest
  port: 8000

- name: image-generation-model
  image: image-model:latest
  port: 8001

# ログ設定
logging:
  output_dir: /var/log/ai-proxy
  level: INFO
```

## 検証ルール
- サービス名とイメージ名は空でないこと
- ポート番号は1〜65535の範囲内であること
- ログレベルは有効な値（DEBUG, INFO, WARNING, ERROR, CRITICAL）であること
- 出力ディレクトリは空でないこと
- サービスは少なくとも1つ定義されていること 